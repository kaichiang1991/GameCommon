!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var n in i)("object"==typeof exports?exports:e)[n]=i[n]}}(self,(function(){return(()=>{var e={32:(e,t,i)=>{"use strict";e.exports=i.p+"assets/audio/98d43d9e0114dee8e654.mp3"},372:(e,t,i)=>{"use strict";e.exports=i.p+"assets/audio/956a52763d3f9b911c73.mp3"},79:(e,t,i)=>{"use strict";e.exports=i.p+"assets/audio/636d7b406e129f87ce48.mp3"},144:(e,t,i)=>{"use strict";e.exports=i.p+"assets/font/WinNum.fnt"},717:(e,t,i)=>{"use strict";e.exports=i.p+"assets/img/BigWinCoin.json"},461:(e,t,i)=>{"use strict";e.exports=i.p+"assets/img/BigWin_Emitter.json"},140:(e,t,i)=>{"use strict";e.exports=i.p+"assets/img/WinAnim.atlas"},705:(e,t,i)=>{"use strict";e.exports=i.p+"assets/img/WinAnim.json"},485:(e,t,i)=>{"use strict";e.exports=i.p+"assets/img_webp/BigWinCoin.json"},98:(e,t,i)=>{"use strict";e.exports=i.p+"assets/img_webp/BigWinCoin.webp"},862:(e,t,i)=>{"use strict";e.exports=i.p+"assets/img_webp/BigWin_Emitter.json"},232:(e,t,i)=>{"use strict";e.exports=i.p+"assets/img_webp/WinAnim.atlas"},574:(e,t,i)=>{"use strict";e.exports=i.p+"assets/img_webp/WinAnim.json"},273:(e,t,i)=>{"use strict";e.exports=i.p+"assets/img_webp/WinAnim.webp"},57:(e,t,i)=>{var n={"./audio/MBN00001_Bigwin_Score.mp3":32,"./audio/SBN00001_Bigwin_Next_Level.mp3":372,"./audio/SBN00002_Bigwin_Finish.mp3":79,"./font/WinNum.fnt":144,"./font/WinNum_0.png":667,"./img/BigWinCoin.json":717,"./img/BigWinCoin.png":136,"./img/BigWin_Emitter.json":461,"./img/WinAnim.atlas":140,"./img/WinAnim.json":705,"./img/WinAnim.png":966,"./img_webp/BigWinCoin.json":485,"./img_webp/BigWinCoin.webp":98,"./img_webp/BigWin_Emitter.json":862,"./img_webp/WinAnim.atlas":232,"./img_webp/WinAnim.json":574,"./img_webp/WinAnim.webp":273};function r(e){var t=s(e);return i(t)}function s(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=s,e.exports=r,r.id=57},766:(e,t,i)=>{const{name:n,version:r}=i(37);e.exports={name:n,version:r,size:{width:720,height:1280},fps:60,canUseWebp:!1,portrait:!0}},667:(e,t,i)=>{"use strict";e.exports=i.p+"assets/font/WinNum_0.png"},136:(e,t,i)=>{"use strict";e.exports=i.p+"assets/img/BigWinCoin.png"},966:(e,t,i)=>{"use strict";e.exports=i.p+"assets/img/WinAnim.png"},289:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t},o=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var i,n,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return Array.isArray(e)||(e=[e]),[4,Promise.all(e.map((function(e){return Promise.resolve().then((function(){return s(i(57)("./"+e))}))})))];case 1:return[2,t.sent().map((function(e){return e.default}))]}}))}))}},570:function(e,t,i){"use strict";this&&this.__assign;var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t},o=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var i,n,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BigWinManager=t.eBigWinType=void 0;var c=s(i(295));window.PIXI=c;var l=u(i(15));window.gsap=l.default;var p,f,h=u(i(766)),d=u(i(550)),g=u(i(289)),m=h.default.name,b=h.default.version,w=PixiAsset.Container,v=PixiAsset.Graphics,y=PixiAsset.JSON,W=PixiAsset.AssetLoader,x=PixiAsset.BitmapText,_=PixiAsset.AnimatedSprite,B=PixiAsset.ParticleEmitter,j=PixiAsset.Spine,P=PixiAsset.PixiSound;!function(e){e.font="WinNum",e.coin="coin",e.emitter="emitter",e.spine="BigWinSpine"}(p||(p={})),function(e){e[e.light=0]="light",e[e.particle=1]="particle",e[e.cont=2]="cont"}(f||(f={}));var C,A,k=["inBigWin","inMegaWin","inHugeWin","inSuperWin"],S="sitchEvent";!function(e){e[e.none=0]="none",e[e.bigWin=1]="bigWin",e[e.megaWin=2]="megaWin",e[e.hugeWin=3]="hugeWin",e[e.superWin=4]="superWin"}(C=t.eBigWinType||(t.eBigWinType={})),function(e){e.background="MBN00001_Bigwin_Score",e.switch="SBN00001_Bigwin_Next_Level",e.finish="SBN00002_Bigwin_Finish"}(A||(A={}));var T=function(){function e(){}return e.init=function(e,t,i,n,r){return o(this,void 0,void 0,(function(){var s,o,u,c,l,f,h,w,v=this;return a(this,(function(a){switch(a.label){case 0:return console.log("%c"+m+" 版號: "+b,"color:#E6A23C; background-color:#909399; font-size:16px; padding:0 5px; font-family: 600 Ariel"),this.config=t,this.winInterval=i.slice(),4!=this.winInterval.length?(Debug.error("BigWinManager init: 間隔不正確",this.winInterval),[2]):(s=this,[4,y.getJson(d.default.toString())]);case 1:return s.setting=a.sent(),[4,W.init(e)];case 2:return a.sent(),[4,g.default(["font/WinNum.fnt","img/BigWinCoin.json","img/BigWin_Emitter.json","img/WinAnim.json"].map((function(e){return v.config.canUseWebp?pathConvert(e):e})))];case 3:return o=a.sent().slice(0),[4,x.init((l={},l[p.font]=o[0],l))];case 4:return a.sent(),[4,_.init((f={},f[p.coin]={name:p.coin,source:o[1],animName:"BigWinCoin"},f))];case 5:return a.sent(),[4,B.init(t.fps,(h={},h[p.emitter]=o[2],h))];case 6:return a.sent(),[4,j.init((w={},w[p.spine]=o[3],w))];case 7:return a.sent(),this.isPlaying=!1,this.stopTrigger=n,this.audioFunction=r,u={},[4,g.default(Object.values(A).map((function(e){return"audio/"+e+".mp3"})))];case 8:return c=a.sent().slice(0),Object.values(A).map((function(e,t){return u[e]=c[t]})),[4,P.init(u)];case 9:return a.sent(),[2]}}))}))},e.playBigWin=function(e,t,i){return o(this,void 0,void 0,(function(){var n,r,s,o,u,h,d,g,m,b,y,W,x,_,P,T,N=this;return a(this,(function(a){switch(a.label){case 0:return this.totalBet=t,this.winType=this.getBigWinType(i),this.winType==C.none?[2]:(n=this.stopTrigger,r=n.level,s=n.function,this.winType>=r&&s(),this.isPlaying?(Debug.warn("playBigWin while it's playing."),[2]):(o=this.setting,u=o.blackAlpha,h=o.preDelay,d=o.endDelay,g=o.fadeoutDur,m=o.afterFadeoutDelay,b=this.audioFunction,y=b.pauseMusic,W=b.playAudio,x=b.stopAudio,[4,Sleep(h)]));case 1:return a.sent(),y(),this.backgroundAudio=W(A.background,!0)[0],this.isPlaying=!0,this.parent=e.addChild(new v("black").drawColorRect(0,u,new c.Point(-640,-640),1280,1280)),this.parent.interactive=!0,_=j.playSpine(p.spine,"Light",!0)[0],P=B.playAnimatedParticle(this.parent,p.emitter,p.coin,{framerate:20}),this.bigWinCont=this.parent.addChild(new w("BigWinCont",f.cont)),this.word=j.playSpine(p.spine,k[0])[0],this.word.y-=100,this.word.on(S,(function(e){var t=e.index,i=k[t];N.word.setAnimation(i),W(A.switch)})),T=this.playScrolling(i),this.parent.addChild(_),this.bigWinCont.addChild(this.word),_.zIndex=f.light,P.parent.zIndex=f.particle,this.parent.sortChildren(),(this.resizeFn=EventHandler.on(eEventName.orientationChange,this.resize.bind(this)))(),[4,T];case 2:return a.sent(),x(this.backgroundAudio),W(A.finish),[4,Sleep(d)];case 3:return a.sent(),[4,waitTweenComplete(l.default.to(this.parent,{duration:g,alpha:0}))];case 4:return a.sent(),[4,Sleep(m)];case 5:return a.sent(),this.endBigWin(),[2]}}))}))},e.playScrolling=function(e){return o(this,void 0,void 0,(function(){var t,i,n,r,s,o,u,f,h,d,g,m,b,w,v,y,W,_=this;return a(this,(function(a){switch(a.label){case 0:return this.number=x.drawFont("bigWinNumber",p.font,19,new c.Point(0,30)),this.number.setParent(this.bigWinCont),t=this.getDuration(),i=t[0],t[1],t[2],t[3],n={value:0},r=this.winInterval.map((function(e){return _.totalBet*e})),s=i,o=e>r[1]?r[1]:e,u=l.default.timeline({defaults:{ease:Power0.easeNone}}).to(n,{duration:s,value:o}),this.winType>=C.megaWin&&(m=2,f=r.slice(1,m+1),w=f[0],h=f[1],v=this.setting.durationInterval[1],u.call((function(){return _.word.emit(S,{index:1})})),s=((o=e>h?h:e)-w)/(h-w)*v,u.to(n,{duration:s,value:o})),this.winType>=C.hugeWin&&(m=3,d=r.slice(2,m+1),w=d[0],g=d[1],v=this.setting.durationInterval[2],u.call((function(){return _.word.emit(S,{index:2})})),s=((o=e>g?g:e)-w)/(g-w)*v,u.to(n,{duration:s,value:o})),this.winType>=C.superWin&&(m=4,b=r.slice(3,m+1),w=b[0],b[1],v=this.setting.durationInterval[3],u.call((function(){return _.word.emit(S,{index:3})})),s=(s=((o=e)-w)/this.totalBet/v)>v?v:s,u.to(n,{duration:s,value:o})),y="skipBigWin",W=function(){return u.isActive()&&u.progress(1,!1)},u.eventCallback("onStart",(function(){_.parent.on("pointerdown",W),CustomInteractionManager.once(eCustomType.keyboard,y,W)})),u.eventCallback("onUpdate",(function(){_.number.text=MathTool.convertNumDisplay(n.value)})),[4,waitTweenComplete(u)];case 1:return a.sent(),this.parent.removeAllListeners(),CustomInteractionManager.off(y),[2]}}))}))},e.endBigWin=function(){EventHandler.off(eEventName.orientationChange,this.resizeFn),this.parent.destroy(),this.isPlaying=!1,this.winType=C.none,this.audioFunction.resumeMusic()},e.getBigWinType=function(e){var t=e/this.totalBet;return t<this.winInterval[0]?C.none:t<this.winInterval[1]?C.bigWin:t<this.winInterval[2]?C.megaWin:t<this.winInterval[3]?C.hugeWin:C.superWin},e.getDuration=function(){return this.setting.durationInterval.slice(0,this.winType)},e.resize=function(){var e=this.config,t=e.portrait,i=e.size,n=i.width,r=i.height;t?(this.parent.position.set(n/2,r/2),this.bigWinCont.scale.set(this.setting.portraitScale)):(this.parent.position.set(r/2,n/2),this.bigWinCont.scale.set(1))},e}();t.BigWinManager=T},37:e=>{"use strict";e.exports=JSON.parse('{"name":"BigWinManager","version":"0.0.0","description":"","scripts":{"crlfConvert":"node buildTool/crlfConvert.js","fileParse":"node buildTool/fileParse.js","build:dev":"npm run crlfConvert && npm run fileParse && webpack --config webpack.dev.js","serve":"live-server ./dist","start":"concurrently \'npm:build:dev\' \'npm:serve\'","build":"npm run crlfConvert && npm run fileParse && webpack --config webpack.prod.js && node buildTool/buildFileParse.js"},"keywords":[],"author":"","license":"ISC","devDependencies":{"@types/node":"^15.0.2","clean-webpack-plugin":"^4.0.0-alpha.0","concurrently":"^6.0.2","copy-webpack-plugin":"^8.1.1","copyfiles":"^2.4.1","crlf":"^1.1.1","fs-extra":"^10.0.0","html-webpack-plugin":"^5.3.1","image-minimizer-webpack-plugin":"^2.2.0","imagemin":"^8.0.0","imagemin-pngquant":"^9.0.2","imagemin-webp":"^6.0.0","live-server":"^1.2.1","md5-dir":"^0.2.0","replace-in-file":"^6.2.0","replace-in-file-webpack-plugin":"^1.0.6","ts-loader":"^9.1.1","typescript":"^4.2.4","webpack":"^5.36.2","webpack-cli":"^4.6.0","webpack-merge":"^5.7.3"},"dependencies":{"@pixi/sound":"4.0.2","dat.gui":"^0.7.7","gsap":"3.6.0","number-precision":"^1.5.0","pixi-particles":"4.3.0","pixi-spine":"2.1.14","pixi.js-legacy":"5.3.9"}}')},550:(e,t,i)=>{"use strict";e.exports=i.p+"setting.json"},295:e=>{"use strict";e.exports=window.PIXI},15:e=>{"use strict";e.exports=window.gsap}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,i),s.exports}return i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),i(570)})()}));